{"ast":null,"code":"import{Link,useHistory}from'react-router-dom';import InfoTooltip from'./InfoTooltip';import{CurrentUserContext}from'../contexts/CurrentUserContext';import{useEffect,useState,useContext}from'react';import{authorize}from'../utils/auth';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Login(_ref){let{setLoggedIn,setMessage,message}=_ref;const{setIsMobileOpen,isMobileOpen}=useContext(CurrentUserContext);const history=useHistory();const[formData,setFormData]=useState({email:'',password:''});const[popOpenFail,setPopOpenFail]=useState(false);const[popOpenSuccess,setPopOpenSuccess]=useState(false);function handleSubmit(e){e.preventDefault();const{email,password}=formData;authorize(password,email).then(res=>{if(res.token){setMessage('Inicio de sesión exitoso');localStorage.setItem('token',res.token);setPopOpenSuccess(true);setIsMobileOpen(false);}}).catch(err=>{setPopOpenFail(true);});}useEffect(()=>{if(popOpenSuccess){// setTimeout(() => {\nsetPopOpenSuccess(false);setFormData({email:'',password:''});setLoggedIn(true);history.push('/');// }, 3000);\n}},[popOpenSuccess,history,setLoggedIn]);const handleChange=e=>{setFormData({...formData,[e.target.name]:e.target.value});};const handleClosePopUp=()=>{setPopOpenFail(false);setPopOpenSuccess(false);};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"register__content\",children:[/*#__PURE__*/_jsxs(\"form\",{className:\"register__form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"h2\",{className:\"register__title\",children:\"Inicia sesi\\xF3n\"}),/*#__PURE__*/_jsx(\"input\",{className:\"register__input\",name:\"email\",type:\"email\",placeholder:\"Correo Electronico\",value:formData.email,onChange:handleChange}),/*#__PURE__*/_jsx(\"input\",{className:\"register__input\",name:\"password\",type:\"password\",placeholder:\"Contrase\\xF1a\",value:formData.password,onChange:handleChange}),/*#__PURE__*/_jsx(\"button\",{className:\"register__button\",children:\"Inicia sesi\\xF3n\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"register__subtitle\",children:[\"\\xBFA\\xFAn no eres miembro? Reg\\xEDstrate \",/*#__PURE__*/_jsx(Link,{to:\"/signup\",children:\"aqu\\xED\"})]})]}),/*#__PURE__*/_jsx(InfoTooltip,{onSuccess:popOpenSuccess,onFail:popOpenFail,onClose:handleClosePopUp,message:message})]})});}export default Login;","map":{"version":3,"names":["Link","useHistory","InfoTooltip","CurrentUserContext","useEffect","useState","useContext","authorize","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Login","_ref","setLoggedIn","setMessage","message","setIsMobileOpen","isMobileOpen","history","formData","setFormData","email","password","popOpenFail","setPopOpenFail","popOpenSuccess","setPopOpenSuccess","handleSubmit","e","preventDefault","then","res","token","localStorage","setItem","catch","err","push","handleChange","target","name","value","handleClosePopUp","children","className","onSubmit","type","placeholder","onChange","to","onSuccess","onFail","onClose"],"sources":["/Users/dvidalv/Dev/web_project_around_auth/src/components/Login.js"],"sourcesContent":["import { Link, useHistory } from 'react-router-dom';\nimport InfoTooltip from './InfoTooltip';\nimport { CurrentUserContext } from '../contexts/CurrentUserContext';\nimport { useEffect, useState, useContext } from 'react';\nimport { authorize } from '../utils/auth';\n\nfunction Login({ setLoggedIn, setMessage, message }) {\n  const { setIsMobileOpen, isMobileOpen } = useContext(CurrentUserContext);\n\n  const history = useHistory();\n  const [formData, setFormData] = useState({\n    email: '',\n    password: '',\n  });\n  const [popOpenFail, setPopOpenFail] = useState(false);\n  const [popOpenSuccess, setPopOpenSuccess] = useState(false);\n\n  function handleSubmit(e) {\n    e.preventDefault();\n    const { email, password } = formData;\n    authorize(password, email)\n      .then((res) => {\n        if (res.token) {\n          setMessage('Inicio de sesión exitoso');\n          localStorage.setItem('token', res.token);\n          setPopOpenSuccess(true);\n          setIsMobileOpen(false);\n        }\n      })\n      .catch((err) => {\n        setPopOpenFail(true);\n      });\n  }\n  useEffect(() => {\n    if (popOpenSuccess) {\n      // setTimeout(() => {\n      setPopOpenSuccess(false);\n      setFormData({\n        email: '',\n        password: '',\n      });\n      setLoggedIn(true);\n      history.push('/');\n      // }, 3000);\n    }\n  }, [popOpenSuccess, history, setLoggedIn]);\n\n  const handleChange = (e) => {\n    setFormData({\n      ...formData,\n      [e.target.name]: e.target.value,\n    });\n  };\n  const handleClosePopUp = () => {\n    setPopOpenFail(false);\n    setPopOpenSuccess(false);\n  };\n\n  return (\n    <>\n      <div className=\"register__content\">\n        <form className=\"register__form\" onSubmit={handleSubmit}>\n          <h2 className=\"register__title\">Inicia sesión</h2>\n          <input\n            className=\"register__input\"\n            name=\"email\"\n            type=\"email\"\n            placeholder=\"Correo Electronico\"\n            value={formData.email}\n            onChange={handleChange}\n          />\n          <input\n            className=\"register__input\"\n            name=\"password\"\n            type=\"password\"\n            placeholder=\"Contraseña\"\n            value={formData.password}\n            onChange={handleChange}\n          />\n          <button className=\"register__button\">Inicia sesión</button>\n          <p className=\"register__subtitle\">\n            ¿Aún no eres miembro? Regístrate <Link to=\"/signup\">aquí</Link>\n          </p>\n        </form>\n        <InfoTooltip\n          onSuccess={popOpenSuccess}\n          onFail={popOpenFail}\n          onClose={handleClosePopUp}\n          message={message}\n        />\n      </div>\n    </>\n  );\n}\n\nexport default Login;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}